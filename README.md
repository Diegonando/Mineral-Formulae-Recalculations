# Mineral-Formulae-Recalculations
Matlab codes for the recalculations of mineral formulae from microprobe data. 

Codes are available in Matlab programming language for the following minerals: 

Amphibole - Follows the formula recalculation scheme in the appendix of Leake et al. (1997) and Hawthorne et al. (2012) requires the use of multiple 9 functions (8 labeled amph, and 1 labeled StrctFrm). 

Chlorite - Calculates structural formula assuming all Fe is FeO and calculates the fractions for the sudonite, clinochlore, chamosite, nimite, and pennnantite endmembers. Normalizes to 14 oxygens. 

Chloritoid - Calculates clinopyroxene structural formula using the charge balance method #2 of Schumacher (1991) for Fe3+ estimation. NOTE: The O2 deficiency (12 oxygens in the ideal formula - calculated total moles of O2) must be greater than zero for this method to be valid and is shown in APFU(:,13).

Clinopyroxene_FeO - Calculates clinopyroxene structural formula assuming all Fe is FeO and calculates the fractions for wollastonite, ferrosilite, enstatite, jadeite, aegerine (acmite), and kosmochlor. The following plots are autogenerated: 1. Q-J plot for distinguishing calcic, calcic-sodic, and sodic pyroxenes, 2. Ternary plot for calcic pyroxenes, and 3. Ternary plot for calcic-sodic and sodic pyroxenes. 

Clinopyroxene - Calculates clinopyroxene structural formula using the charge balance method #2 of Schumacher (1991) for Fe3+ estimation. NOTE: The O2 deficiency (6 oxygens in the ideal formula - calculated total moles of O2) must be greater than zero for this method to be valid and is shown in APFU(:,13). The code calculates the fractions for wollastonite, ferrosilite, enstatite, jadeite, aegerine (acmite), and kosmochlor. The following plots are autogenerated: 1. Q-J plot for distinguishing calcic, calcic-sodic, and sodic pyroxenes, 2. Ternary plot for calcic pyroxenes, and 3. Ternary plot for calcic-sodic and sodic pyroxenes. 

Epidote - Calculartes the epidote structural formula assuming Fe is Fe2O3. Not valid for REE rich compositions. Normalization is to 12.5 oxygens. 

Feldspar - Calculates the feldspar structural formula normalized to 5 cations annd calculats the fractions of anorthite, albite, and orthoclase. The feldspar ternary is plotted automatically. 

Garnet - Calculates clinopyroxene structural formula using the charge balance method #2 of Schumacher (1991) for Fe3+ estimation. NOTE: The O2 deficiency (12 oxygens in the ideal formula - calculated total moles of O2) must be greater than zero for this method to be valid and is shown in APFU(:,13). The code calculates the fractions for almandine, pyrope, spessartine, grossular, andradite, and uvarovite. 

Mica - Calculates the mica structural formula assuming all Fe is FeO and works for both trioctohedral mica (e.g., biotite) and dioctohedral mica (e.g., muscovite). Normalization is to 11 Oxygens. Calculates the trioctohedral mica endmember fractions (phlogopite, annite, eastonite, siderophyllite, dioctohedral component) and dioctohedral endmember fractions (muscovite, Fe-celadonite, Mg-celadonite, paragonite, margarite, trioctohedral component). 

Olivine - Calculates olivine structural formula using the charge balance method #2 of Schumacher (1991) for Fe3+ estimation. Note: The O2 deficiency (4 oxygens in the ideal formula - calculated total moles of O2) must be greater than zero for this method to be valid and is shown in APFU(:,12). The code calculations the fractions of forsterite, fayallite, tephroite (Mn olivine), and larnite (Ca olivine). 

Orthopyroxene - Calculates orthopyroxene structural formula using the charge balance method #2 of Schumacher (1991) for Fe3+ estimation. Basically a simplified version of the clinopyroxene code for convenience (e.g., plots only the wollastonite, enstatite, ferrosillite ternary). 

Titanite - Calculates the titanite structural formula assuming all Fe is Fe2O3. Normalized to 2 cations in the tetrahedral and octohedral sites. 
